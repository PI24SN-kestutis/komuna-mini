<!-- Naudojame layout.html -->
<div th:fragment="main-content" xmlns:th="http://www.w3.org/1999/xhtml">
    <div th:switch="${view}">

        <!-- OVERVIEW -->
        <div th:case="'overview'">
            <h2>Mano bendrijos statistika</h2>
            <div class="cards">
                <div class="card">
                    <h3>Gyventojų</h3>
                    <div class="number" th:text="${residentsCount}">0</div>
                </div>
                <div class="card">
                    <h3>Paslaugų</h3>
                    <div class="number" th:text="${feesCount}">0</div>
                </div>
                <div class="card">
                    <h3>Kainų</h3>
                    <div class="number" th:text="${pricesCount}">0</div>
                </div>
            </div>
        </div>

        <!-- RESIDENTS -->
        <div th:case="'residents'">
            <h2>Gyventojai</h2>
            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Vardas</th>
                    <th>El. paštas</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="r : ${residents}">
                    <td th:text="${r.id}"></td>
                    <td th:text="${r.name}"></td>
                    <td th:text="${r.email}"></td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- PRICES -->
        <div th:case="'fees'">
            <h2>Paslaugų kainos</h2>
            <button class="add-btn" onclick="openModal('add-price')">+ Nauja kaina</button>

            <table>
                <thead>
                <tr>
                    <th>Paslauga</th>
                    <th>Kaina (€)</th>
                    <th>Galioja</th>
                    <th>Veiksmai</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="p : ${prices}">
                    <td th:text="${p.fee.name}"></td>
                    <td th:text="${#numbers.formatDecimal(p.amount, 1, 2)}"></td>
                    <td>
                        <span class="price-date"
                              th:text="${p.validTo != null
                                  ? '(' + #temporals.format(p.validFrom, 'yyyy-MM-dd') + ' – ' + #temporals.format(p.validTo, 'yyyy-MM-dd') + ')'
                                  : '(nuo ' + #temporals.format(p.validFrom, 'yyyy-MM-dd') + ')'}">
                        </span>
                    </td>
                    <td class="actions">
                        <button class="edit"
                                th:attr="data-id=${p.id},
                                         data-feeid=${p.fee.id},
                                         data-communityid=${p.community.id},
                                         data-amount=${p.amount},
                                         data-validfrom=${p.validFrom},
                                         data-validto=${p.validTo}"
                                onclick="openEditPrice(this)">
                            Redaguoti
                        </button>
                        <button class="delete"
                                th:onclick="|openModal('confirm-delete', {url: '@{/prices/{id}(id=${p.id})}'})|">
                            Trinti
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

    </div>
</div>
