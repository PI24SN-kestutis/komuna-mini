<div th:fragment="main-content" xmlns:th="http://www.thymeleaf.org">

    <div th:switch="${view}">

        <!-- === OVERVIEW === -->
        <div th:case="'overview'">
            <h2>Statistika</h2>
            <div class="cards">
                <div class="card">
                    <h3>Gyventojų</h3>
                    <div class="number" th:text="${residentsCount}">0</div>
                </div>
                <div class="card">
                    <h3>Mokesčių</h3>
                    <div class="number" th:text="${feesCount}">0</div>
                </div>
                <div class="card">
                    <h3>Sumokėta (€)</h3>
                    <div class="number" th:text="${totalPaid}">0</div>
                </div>
                <div class="card">
                    <h3>Nesumokėta (€)</h3>
                    <div class="number" th:text="${totalUnpaid}">0</div>
                </div>
            </div>
        </div>

        <!-- === RESIDENTS === -->
        <div th:case="'residents'">
            <h2>Gyventojai</h2>
            <button class="add-btn" onclick="openModal('add-resident')">+ Naujas gyventojas</button>

            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Vardas</th>
                    <th>El. paštas</th>
                    <th>Veiksmai</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="r : ${residents}">
                    <td th:text="${r.id}"></td>
                    <td th:text="${r.name}"></td>
                    <td th:text="${r.email}"></td>
                    <td class="actions">
                        <button class="edit"
                                th:attr="data-id=${r.id}, data-name=${r.name}, data-email=${r.email}"
                                onclick="openEditResident(this)">
                            Redaguoti
                        </button>
                        <button class="delete"
                                th:attr="data-url=@{'/users/' + ${r.id}}"
                                onclick="openModal('confirm-delete', {url: this.dataset.url})">
                            Šalinti
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- === FEES === -->
        <div th:case="'fees'">
            <h2>Mokesčiai</h2>
            <button class="add-btn" onclick="openModal('add-fee')">+ Naujas įrašas</button>

            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Tipas</th>
                    <th>Suma</th>
                    <th>Apmokėta</th>
                    <th>Gyventojas</th>
                    <th>Veiksmai</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="f : ${fees}">
                    <td th:text="${f.id}"></td>
                    <td th:text="${f.type}"></td>
                    <td th:text="${f.amount}"></td>
                    <td th:text="${f.paid} ? 'Taip' : 'Ne'"></td>
                    <td th:text="${f.user != null ? f.user.name : '-'}"></td>
                    <td class="actions">
                        <button class="edit"
                                th:attr="data-id=${f.id}, data-type=${f.type}, data-amount=${f.amount}, data-paid=${f.paid}"
                                onclick="openEditFee(this)">
                            Redaguoti
                        </button>
                        <button class="delete"
                                th:attr="data-url=@{'/fees/' + ${f.id}}"
                                onclick="openModal('confirm-delete', {url: this.dataset.url})">
                            Šalinti
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- === REPORTS === -->
        <div th:case="'reports'">
            <h2>Bendrijos ataskaita</h2>
            <button type="button"
                    onclick="window.location.href='/dashboard/manager/reports/export'"
                    style="margin-bottom:10px;">
                Generuoti CSV
            </button>


            <table>
                <thead>
                <tr>
                    <th>Gyventojas</th>
                    <th>Tipas</th>
                    <th>Suma (€)</th>
                    <th>Apmokėta</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="r : ${reports}">
                    <td th:text="${r.user != null ? r.user.name : '-'}"></td>
                    <td th:text="${r.type}"></td>
                    <td th:text="${r.amount}"></td>
                    <td th:text="${r.paid ? 'Taip' : 'Ne'}"></td>
                </tr>
                </tbody>
            </table>
        </div>


    </div>
</div>
