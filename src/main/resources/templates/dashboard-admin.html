<!-- Naudojame layout.html -->
<div th:fragment="main-content" xmlns:th="http://www.w3.org/1999/xhtml">
    <div th:switch="${view}">

        <!-- OVERVIEW -->
        <div th:case="'overview'">
            <h2>Statistika</h2>
            <div class="cards">
                <div class="card">
                    <h3>Bendrijų</h3>
                    <div class="number" th:text="${communitiesCount}">0</div>
                </div>
                <div class="card">
                    <h3>Vartotojų</h3>
                    <div class="number" th:text="${usersCount}">0</div>
                </div>
                <div class="card">
                    <h3>Paslaugų</h3>
                    <div class="number" th:text="${feesCount}">0</div>
                </div>
            </div>
        </div>

        <!-- COMMUNITIES -->
        <div th:case="'communities'">
            <h2>Bendrijos</h2>
            <button class="add-btn" onclick="openModal('add-community')">+ Nauja bendrija</button>
            <table>
                <thead>
                <tr>
                    <th>Kodas</th>
                    <th>Pavadinimas</th>
                    <th>Adresas</th>
                    <th>Veiksmai</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="c : ${communities}">
                    <td th:text="${c.code}"></td>
                    <td th:text="${c.name}"></td>
                    <td th:text="${c.address}"></td>
                    <td class="actions">
                        <button class="edit"
                                th:attr="data-id=${c.id}, data-code=${c.code}, data-name=${c.name}, data-address=${c.address}"
                                onclick="openEditCommunity(this)">
                            Redaguoti
                        </button>

                        <button class="delete"
                                th:onclick="|openModal('confirm-delete', {url: '@{/communities/{id}(id=${c.id})}'})|">
                            Trinti
                        </button>
                    </td>

                </tr>
                </tbody>
            </table>
        </div>

        <!-- USERS -->
        <div th:case="'users'">
            <h2>Vartotojai</h2>
            <button class="add-btn" onclick="openModal('add-user')">+ Naujas vartotojas</button>
            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Vardas</th>
                    <th>El. paštas</th>
                    <th>Rolė</th>
                    <th>Bendrija</th>
                    <th>Veiksmai</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="u : ${users}">
                    <td th:text="${u.id}"></td>
                    <td th:text="${u.name}"></td>
                    <td th:text="${u.email}"></td>
                    <td th:text="${u.role.name}"></td>
                    <td th:text="${u.community != null ? u.community.name : '-'}"></td>
                    <td class="actions">
                        <button class="edit"
                                th:attr="data-id=${u.id},
                     data-name=${u.name},
                     data-email=${u.email},
                     data-role=${u.role != null ? u.role.name : ''}"
                                onclick="openEditUser(this)">
                            Redaguoti
                        </button>

                        <button class="delete"
                                th:onclick="|openModal('confirm-delete', {url: '@{/users/{id}(id=${u.id})}'})|">
                            Trinti
                        </button>
                    </td>

                </tr>
                </tbody>
            </table>
        </div>

        <!-- FEES -->
        <div th:case="'fees'">
            <h2>Paslaugos / Mokesčiai</h2>
            <button class="add-btn" onclick="openModal('add-fee')">+ Naujas įrašas</button>
            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Tipas</th>
                    <th>Suma</th>
                    <th>Apmokėta</th>
                    <th>Vartotojas</th>
                    <th>Veiksmai</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="f : ${fees}">
                    <td th:text="${f.id}"></td>
                    <td th:text="${f.type}"></td>
                    <td th:text="${f.amount}"></td>
                    <td th:text="${f.paid} ? 'Taip' : 'Ne'"></td>
                    <td th:text="${f.user != null ? f.user.name : '-'}"></td>
                    <td class="actions">
                        <button class="edit"
                                th:attr="data-id=${f.id},
                     data-type=${f.type},
                     data-amount=${f.amount},
                     data-paid=${f.paid},
                     data-userId=${f.user != null ? f.user.id : ''}"
                                onclick="openEditFee(this)">
                            Redaguoti
                        </button>

                        <button class="delete"
                                th:onclick="|openModal('confirm-delete', {url: '@{/fees/{id}(id=${f.id})}'})|">
                            Trinti
                        </button>
                    </td>

                </tr>
                </tbody>
            </table>
        </div>

    </div>
</div>
